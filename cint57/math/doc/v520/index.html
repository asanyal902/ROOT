<br>
<hr>
<a name="math"></a>
<h3>MathCore</h3>
<p>MathCore contains now the classes in the math directory, <tt>TMath</tt>, <tt>TComplex</tt> and the <tt>TRandom</tt> classes. This implies that all other ROOT library using one of these classes, such as <em>libHist</em>, have a direct dependency on the Mathcore library.
Linking with <em>libMathCore</em> is therefore required for running any major ROOT application. It has been added to the list of libraries obtained when doing <em>root-config --libs</em>.
<p>
<strong>N.B. users building ROOT applications and not  using <em>root-config</em> MUST add <em>libMathCore</em> to their list of linking libraries.
</strong>
<p>
Together with the libraries merge, many changes have been applied to both TMath and the other mathcore classes.
<h4>TMath</h4>
A major clean-up and re-structuring has been performed for the TMath functions. In particular some functions have been implemented  using STL algorithms which have shown for these case better performances in term of CPU time. The file <em>TMathImp.h</em> contains the implementations for the template functions. 
Some of the basic special functions of TMath, like the error function or the gamma and beta functions use now the  <a href="#" target="http:://www.netlib.org/cephes">Cephes</a> implementation from Stephen L. Moshier, which is used by the  <tt>ROOT::Math</tt> functions and it has been found to be more accurate and in some cases even faster.  
<ul>
  <li>use template functions instead of having the same function for all the various basic types, for functions like <tt>TMath::Mean</tt>,<tt>TMath::GeomMean</tt>, <tt>TMath::Median</tt>, <tt>TMath::KOrdStat</tt>
  <li>Use STL to implement the following  TMath algorithms: 
  <ul>  
  <li> <tt>TMath::Sort</tt> re-implemented using <tt>std::sort</tt>.</li>
  <li><tt>TMath::BinarySearch</tt> re-implemented using the STL algorithm <tt>std::lower_bound</tt></li>
  </ul>
 The STL algorithms were found in these cases to be more performant in term of CPU time. For some like   <tt>TMath::LocMin</tt>, <tt>TMath::LocMax</tt> or <tt>TMath::Permute</tt> the original implementation has been left since it was found to be more performant than the generic one provided by STL.
  </li>
  <li>Add an interface working with generic iterators, similar to the STL algorithm interface, to the following TMath functions:
	<tt>MinElement, MaxElemen, LocMin, LocMax, Mean, GeomMean, RMS,
	BinarySearch</tt>. The iterator interface for sort is called
	<tt>TMath::SortItr</tt> to avoid a compilation ambiguity. For example,
	for finding the mean from an <tt>std::vector&lt;double&gt; v</tt> one simply needs to call <tt>TMath::Mean(v.begin(), v.end() ) </tt>
  </li>
  <li>Various changes have been applied to the mathematical function to remove duplications with the special and statistical functions defined in ROOT::Math. In detailed the implementations which have been changed and can return a sightly different result than before are:
  <ul>
  <li><tt>TMath::Erf</tt> and <tt>TMath::Erfc</tt> call <tt>ROOT::Math::erf</tt> and <tt>ROOT::math::erfc</tt> which are implemented using the Cephes algorithms
  <li><tt>TMath::Gamma(z)</tt>  is implemented with <tt>ROOT::Math::tgamma</tt> and the incomplete gamma function, <tt>TMath::Gamma(a,x)</tt> it is implemented using <tt>ROOT::Math::inc_gamma</tt>.</li>
  <li><tt>TMath::Prob(z)</tt> (the upper chi2 probability) is implemented using <tt>ROOT::Math::chisquared_cdf_c</tt> which uses <tt>ROOT::Math::inc_gamma</tt>. </li> 
  <li><tt>TMath::LnGamma(z)</tt> is also implemented using <tt>ROOT::Math::lgamma</tt>. This affects also <tt>TMath::Beta</tt> which is implemented using the log of the gamma function.</li>
  <li><tt>TMath::BetaIncomplete</tt> is implemented using <tt>ROOT::Math::beta_inc</tt>.</li>
  <li><tt>TMath::GammaDist</tt> is implemented using <tt>ROOT::Math::gamma_pdf</tt>.</li>
  <li><tt>TMath::LogNormal</tt> is implemented using <tt>ROOT::Math::lognormal_pdf</tt>.</li>
  <li><tt>TMath::PoissonI</tt>:  fixed a problem for large values and is implemented using directly TMath::Poisson with integer values.
  </ul>
  More detailed information on the new mathematical functions can be found in <a href="http://project-mathlibs.web.cern.ch/project-mathlibs/documents/slawinska.pdf">this</a> presentation from M. Slawinska.
  </li>
</ul>

  <p>
  <h4>Fit</h4>
  Mathcore include now new classes for performing fits and minimization of multi-dimensional functions. These aim of these classes is to extend and improve the fitting functionality provided in ROOT via the <tt>TVirtualFitter</tt> classes and the <tt>Fit</tt> method present in many data analysis object, such as <tt>TH1</tt>.
  <br>
The fit data are decoupled from the fitter class and described by the <tt>ROOT::Fit::BinData</tt> for bin data containing coordinate values of any dimensions, bin content values and optionally errors in coordinate and bin content, and <tt>ROOT::Fit::UnBinData</tt> classes for any dimension un-bin data.<br>
  The fitter class provides the support for fitting those data with any model function implementing the parametric function interface, <tt>ROOT::Math::IParamMultiFunction</tt>. Fit methods such as least square, bin and un-bin likelihood are supported. The fit solution is found by using the <tt>ROOT::Math::Minimizer</tt> class.
  <br>
  Various implementation can be used automatically using the ROOT plug-in manager mechanism, including the linear fitter for a fast and direct solution, in case of a linear least square model, or by using Minuit, Minuit2 or GSL minimization methods provided by the MathMore library.  
<br>
  <p>
 Functions for filling the new <tt>ROOT::Fit::BinData</tt> classes with all the histogram and graph types have been added in the histogram library (<em>libHist</em>) and graph library:  
  <ul>
    <li><tt>ROOT::Fit::FillData( BinData & , const TH1 *, TF1 * )</tt> for histograms  (in libHist)
    <li><tt>ROOT::Fit::FillData( BinData & , const TGraph2D *, TF1 * )</tt> for 2D graphs (in libHist)
    <li><tt>ROOT::Fit::FillData( BinData & , const TGraph *, TF1 * )</tt> for all 1D graphs (in libGraf) 
    <li><tt>ROOT::Fit::FillData( BinData & , const TMultiGraph *, TF1 * )</tt> for multi-graphs (in libGraf)
    </ul>
<p>  
<h4>Additional MathCore changes</h4>

    <ul>
  <li>New classes <tt>GaussIntegrator</tt> and <tt>GaussLegendreIntegrator</tt> for numerical integration of one-dimensional functions. The first class uses Gaussian  8 and 16 point  quadrature approximation, it provides the translation of the CERNLIB algorithm
  <a href="http://wwwasdoc.web.cern.ch/wwwasdoc/shortwrupsdir/d103/top.html">DGAUSS</a> by Sigfried Kolbig,  and it is used by the <tt>TF1::Integral</tt> method. The second one uses the Gauss Legendre quadrature formula. It is used by the <tt>TF1::IntegralFast</tt> method.
  These classes implement both the same  virtual interface as the adaptive integration methods provided by the MathMore library.  They can all be created and used easily via the entry class <tt>ROOT::Math::IntegratorOneDim</tt>. 
</li>
<li>New class <tt>ROOT::Math::RichardsonDerivator</tt> implementing numerical derivation using the Richardson's extrapolation formula (use 2 derivative estimates to compute a third, more accurate estimation). This is used by the <tt>TD1::Derivative</tt> method. </li>
<li>New class <tt>BrentRootFinder</tt> for finding the root of one-dimensional function using the Brent algorithm. The class inherits from a virtual interface, which is also implemented by the MathMore root finder methods. The user can therefore by using the <tt>ROOT::Math::RootFinder</tt> class instantiates the various root finder algorithms.  The <tt>BrentRootFinder</tt> class is used by <tt>TF1::GetX</tt>. A similar class, <tt>BrentMinimizer1D</tt> provides the possibility to find the minimum if a one-dimensional function using  the Brent algorithm. This class is used by <tt>TF1::GetMinimum</tt> or <tt>TF1::GetMaximum</tt> </li>
</ul>

<p>More detailed description of the current MathCore release can be found at this <a href="http://www.cern.ch/mathlibs/sw/5_19_02/html/MathCore.html">location</a>.</p>

  <br>

 <h3>GenVector</h3>
  The new physics vector classes have been moved out from the MathCore library in a new library, <em>libGenVector</em>.  The library contains as well the CINT dictionary including main instantiations for the template classes.
<br>
In addition the setter methods for the 2D,3D and 4D vector classes have been extended following a suggestion by G. Raven. Functions like <tt>SetX</tt> instead of returning a <tt>void</tt> return now a reference to the vector class itself (<tt>*this</tt>).

<h3>SMatrix</h3>
Fix a bug discovered by Harals Soleng in the addition of two matrix expressions. Remove also some compilation warning found on Windows when compiling matrices instantiated using float types.  
<br>
<hr>
<h3>MathMore</h3>
<p>This new release contains: </p>
<ul>
  <li>Modify and rename the class <tt>ROOT::Math::RootFinder</tt> to <tt>ROOT::Math::GSLRootFinder</tt> to distinguish from the main interface class which has been put in the Mathcore library and it can create the GSLRootFinder using the plug-in manager. Furthermore, the class <tt>ROOT::Math::GSLRootFinder</tt> is not anymore a template class on the algorithm. They type of root-finder algorithm can now be selected via an enumeration</li>
  <li>Fixed a bug in the <tt>ROOT::Math::GSLNLSMutiFi</tt> class. 
</ul>

<p>More detailed description of the current MathMore release can be found at this <a href="http://www.cern.ch/mathlibs/sw/5_19_02/html/MathMore.html">location</a>.</p>

  <p>&nbsp;</p>

<br>
<hr>
<h3>Minuit</h3>
  Two new classes have been added:
  <ul>
    <li><tt>TMinuitMinimizer</tt>: implementation of the <tt>ROOT::Math::Minimizer</tt> interface with TMinuit. This class is used for example by the new Fitter class.
    <li><tt>TLinearMinimizer</tt>: implementation of the <tt>ROOT::Math::Minimizer</tt> interface with the TLinearFitter.
  </ul>
In addition, the method <tt>TLinearFitter::SetBasisFunction(TObjArray  * f)</tt> has been added to set directly the linear terms of the fit function.

<br>
<hr>

 <h3>Minuit2</h3>

  Various fixes have been applied to different problems discovered mainly by a test program from Alfio Lazzaro. In detail:
  <ul>
    <li>
 Fix a bug in <tt>MnMinos</tt> which was setting wrong initial values when the parameters were limited.
  This was resulting in a much larger number of function calls used inside <tt>MnMinos</tt>. </li>

<li> Improve <tt>MnHesse</tt> by returning in the final state the improved gradient step values used in <tt>HessianGradientCalculator</tt>. With this change same results are obtained from using Hesse in Minuit2 or TMinuit. In addition, the interface of MnHesse (<tt>MnHesse::operator()</tt> ) has been improved to use it  from the <tt>FunctionMinimum</tt> object (similar to MnMinos) in order to be called after the minimization (Migrad). The API with a <tt>MnUserParameterState</tt> should not be used after minimization, because in that case the latest state information resulting from the minimum (gradient values and step sizes) is lost.  
</li>
<li>Add support in <tt>MnMigrad</tt> and <tt>MnMinimize</tt> for user provided analytical gradient of the FCN function. One needs to pass an instance of a function implementing the <tt>ROOT::Minuit2::FcnGradientBase</tt> interface. 
</li>

<li>
The<tt> Minuit2Minimizer</tt> class has been improved by having an option to always run Hesse if it was not done before during the minimization.
</li>
</ul>

  

<br>
<hr>

 <h3>Unuran</h3>

A new version, 1.2.4, has been added to fix mainly some problems found in gcc 4.3. For the detailed changes of this new UNU.RAN version see the file <tt>$ROOTSYS/math/unuran/src/unuran-1.2.4-root/NEWS</tt>. 

<br>
