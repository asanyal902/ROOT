/*****************************************************************************
 * Project: BaBar detector at the SLAC PEP-II B-factory
 * Package: RooFitCore
 * File: $Id: RooDircShape.rdl,v 1.3 2002/05/24 15:29:25 yeche Exp $
 * Authors:
 *   Lei Zhang, University of Colorado, zhanglei@slac.stanford.edu
 * History:
 *   11-Apr-2002 Lei Zhang, initial version
 *
 * Copyright (C) 2002 University of Colorado
 *****************************************************************************/
#ifndef ROO_DIRC_SHAPE
#define ROO_DIRC_SHAPE

#include "RooFitCore/RooAbsReal.hh"
#include "RooFitCore/RooRealProxy.hh"
#include "RooFitCore/RooCategoryProxy.hh"
#include "RooFitCore/RooRealVar.hh"

class RooDircShape : public RooAbsReal {
public:
  // Constructors, assignment etc
  RooDircShape() ;
  RooDircShape(const char *name, const char *title,
	       RooAbsReal &_trkTheta,
	       RooAbsReal &_Bias,
	       TString _coreTail="Core",
	       TString _meanSigma="Mean",
	       TString _runset="Run1", // run1 reprocessed is treated as Run2
	       TString _dataType="Data",
	       TString _hypothesis="Kaon",
	       TString _shapefile="",
	       Bool_t _useMilliRadian=kFALSE);
  RooDircShape(const RooDircShape& other, const char* name=0) ;
  virtual TObject* clone(const char* newname) const { return new RooDircShape(*this,newname); }  
  virtual ~RooDircShape();
  // set the parameters from your datafile
  virtual void setParams(TString shapefile);
  // write out the parameters
  virtual void writeParams(TString shapefile);

  
protected:
  
  // Function evaluation
  virtual Double_t evaluate() const ;
  // these two should not be called directly
  virtual void setParams(const RooDircShape &other);
  virtual void setParams(Double_t *srcParamsPtr);
  
  Int_t getCosThetaBin() const;
  Double_t dircCubic() const;

  //
  RooRealProxy trkTheta;
  RooRealProxy Bias;
  
  //
  Int_t coreTail;
  Int_t meanSigma;
  Int_t runSet;
  Int_t dataType;
  Int_t hypothesis;
  Double_t mrFactor;

  //               run1/2 data/mc hypok/pi core/tail mean/sigma value
  //                  0 1   0   1    0  1    0   1    0    1
  Double_t ShapeParams[2]    [2]      [2]    [2]       [2]     [19];

  virtual Bool_t isValid() const ;
  virtual Bool_t isValid(Double_t value, Bool_t verbose=kFALSE) const ;
  
  ClassDef(RooDircShape,1) // Dirc Shape function
};

#endif
